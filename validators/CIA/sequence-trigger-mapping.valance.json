{
  "name": "cia-sequence-trigger-mapping",
  "description": "Validates that every SPA plugin registered via CIA is actually triggered at runtime using conductor methods",
  "type": "content",
  "filePattern": ".*\\.(tsx|ts|js|jsx)$",
  "confidenceThreshold": 0.9,
  "version": "1.0.0",
  "author": "Valence CIA Validation System",
  "tags": ["cia", "sequence-trigger", "plugin-mapping", "runtime-validation"],
  "rules": [
    {
      "plugin": "validateSequenceTriggerMapping",
      "checkSequenceStartCalls": true,
      "checkMovementHandlerCalls": true,
      "checkConvenienceFunctions": true,
      "validateTriggerFiles": ["App.tsx", "Canvas.tsx", "index.tsx"],
      "requiredTriggerPatterns": [
        "conductor\\.startSequence\\s*\\(",
        "conductor\\.executeMovementHandler\\s*\\(",
        "startCanvasComponentDragFlow\\s*\\(",
        "startLayoutModeChangeFlow\\s*\\(",
        "startPanelToggleFlow\\s*\\(",
        "startJsonComponentLoadingFlow\\s*\\("
      ],
      "verbose": false
    }
  ],
  "triggerValidation": {
    "requiredMethods": [
      "conductor.startSequence",
      "conductor.executeMovementHandler"
    ],
    "convenienceFunctions": [
      "startCanvasComponentDragFlow",
      "startLayoutModeChangeFlow", 
      "startPanelToggleFlow",
      "startJsonComponentLoadingFlow",
      "startCustomSequence",
      "startCustomCanvasSequence"
    ],
    "triggerFilePatterns": [
      ".*App\\.(tsx|ts|js|jsx)$",
      ".*Canvas\\.(tsx|ts|js|jsx)$",
      ".*index\\.(tsx|ts|js|jsx)$",
      ".*hooks\\.(tsx|ts|js|jsx)$"
    ],
    "sequenceNamePatterns": [
      "['\"].*Symphony.*['\"]",
      "['\"].*Sequence.*['\"]",
      "['\"].*component-drag-symphony['\"]",
      "['\"].*canvas-.*['\"]"
    ]
  },
  "pluginMapping": {
    "expectedPlugins": [
      {
        "id": "component-drag-symphony",
        "expectedTriggers": [
          {
            "file": "App.tsx",
            "method": "startCanvasComponentDragFlow",
            "movement": "onDragStart"
          }
        ]
      },
      {
        "id": "canvas-component-drag-symphony",
        "expectedTriggers": [
          {
            "file": "App.tsx", 
            "method": "conductor.startSequence",
            "sequenceName": "Canvas Component Drag Symphony No. 4"
          }
        ]
      }
    ],
    "dynamicDiscovery": {
      "scanForPlugins": true,
      "pluginDirectories": ["plugins/**/*symphony*", "sequences/**/*symphony*"],
      "manifestFiles": ["manifest.json", "sequence.ts"]
    }
  },
  "documentation": {
    "purpose": "Ensures that every SPA plugin registered via CIA is actually triggered at runtime using conductor methods",
    "scope": "All trigger files (App.tsx, Canvas.tsx, etc.) and plugin registration files",
    "validationTypes": [
      "Sequence trigger validation - conductor.startSequence() calls",
      "Movement handler validation - conductor.executeMovementHandler() calls", 
      "Convenience function validation - startCanvasComponentDragFlow() etc.",
      "Plugin-to-trigger mapping validation",
      "Runtime trigger coverage analysis"
    ],
    "commonIssues": [
      "Plugin registered but never triggered at runtime",
      "Missing conductor.startSequence() calls for registered sequences",
      "Convenience functions defined but not called",
      "Plugin movements defined but handlers never executed",
      "Trigger files missing required sequence calls"
    ]
  }
}
